
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>HW5_Marion_Anderson</title><meta name="generator" content="MATLAB 9.2"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2018-10-03"><meta name="DC.source" content="HW5_Marion_Anderson.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">5.1: Controllability</a></li><li><a href="#3">5.2: Regulator Gains</a></li><li><a href="#4">5.3: Observability</a></li><li><a href="#5">5.4: Estimator Gains</a></li></ul></div><p>Marion Anderson ECE 4550 Fall 2018 HW 5</p><pre class="codeinput">clear; clc; close <span class="string">all</span>

M1 = 1; M2 = 1;

A = [0  0 1 0
     0  0 0 1
    -2  2 0 0
     2 -2 0 0];
B = [0; 0; 1 ;0];
C = [0 1 0 0];
</pre><h2 id="2">5.1: Controllability</h2><pre class="codeinput">scriptC = B;  <span class="comment">% Initial controllability matrix</span>
<span class="keyword">for</span> n = 1:length(A)-1  <span class="comment">% adding to controllability matrix</span>
    scriptC = [scriptC, (A^n) * B];
<span class="keyword">end</span>

fprintf(<span class="string">'\n'</span>); disp(<span class="string">'scriptC ='</span>); fprintf(<span class="string">'\n'</span>)
disp(scriptC)
fprintf(<span class="string">'\n'</span>); disp(<span class="string">'det(scriptC) ='</span>); fprintf(<span class="string">'\n'</span>)
disp(det(scriptC))


<span class="comment">% The controllability matrix has non-zero determinant, and so must be</span>
<span class="comment">% full rank. This system is controllable.</span>
</pre><pre class="codeoutput">
scriptC =

     0     1     0    -2
     0     0     0     2
     1     0    -2     0
     0     0     2     0


det(scriptC) =

    -4

</pre><h2 id="3">5.2: Regulator Gains</h2><pre class="codeinput"><span class="comment">% regulator gain matrix</span>
syms <span class="string">K1</span> <span class="string">K2</span> <span class="string">K3</span> <span class="string">K4</span> <span class="string">s</span>
K = [K1 K2 K3 K4];

sR = -10;  <span class="comment">% desired pole location</span>

<span class="comment">% Symbolic (K) char poly coeffs</span>
KPoly = det(eye(length(A))*s - (A - B*K))
KCoeffs = coeffs(KPoly, s)

<span class="comment">% Numeric char poly coeffs</span>
RegPoly = expand((s-sR)^length(A))
RegCoeffs = coeffs(RegPoly, s)

<span class="comment">% Solve for K from coeffs</span>
KValsStruct = solve(RegCoeffs == KCoeffs);

<span class="comment">% Extract K values</span>
KNames = fieldnames(KValsStruct);
K = [];
<span class="keyword">for</span> i = 1:length(KNames)
    K = [K double(KValsStruct.(KNames{i}))];
<span class="keyword">end</span>
disp(<span class="string">'--------------------------------------------------------'</span>)
K
disp(<span class="string">'--------------------------------------------------------'</span>)

<span class="comment">% Check</span>
AminusBKeig = eig(A - B*K)
</pre><pre class="codeoutput"> 
KPoly =
 
2*K1 + 2*K2 + 2*K3*s + 2*K4*s + K1*s^2 + K3*s^3 + 4*s^2 + s^4
 
 
KCoeffs =
 
[ 2*K1 + 2*K2, 2*K3 + 2*K4, K1 + 4, K3, 1]
 
 
RegPoly =
 
s^4 + 40*s^3 + 600*s^2 + 4000*s + 10000
 
 
RegCoeffs =
 
[ 10000, 4000, 600, 40, 1]
 
--------------------------------------------------------

K =

         596        4404          40        1960

--------------------------------------------------------

AminusBKeig =

 -10.0022 + 0.0000i
 -10.0000 + 0.0022i
 -10.0000 - 0.0022i
  -9.9978 + 0.0000i

</pre><h2 id="4">5.3: Observability</h2><pre class="codeinput">scriptO = C;  <span class="comment">% Initial observability matrix</span>
<span class="keyword">for</span> n = 1:length(A)-1  <span class="comment">% adding to observability matrix</span>
    scriptO = [scriptO; C * (A^n)];
<span class="keyword">end</span>

fprintf(<span class="string">'\n'</span>); disp(<span class="string">'scriptO ='</span>); fprintf(<span class="string">'\n'</span>)
disp(scriptO)
fprintf(<span class="string">'\n'</span>); disp(<span class="string">'det(scriptO) ='</span>); fprintf(<span class="string">'\n'</span>)
disp(det(scriptO))


<span class="comment">% The observability matrix has non-zero determinant, and so must be</span>
<span class="comment">% full rank. This system is observabile.</span>
</pre><pre class="codeoutput">
scriptO =

     0     1     0     0
     0     0     0     1
     2    -2     0     0
     0     0     2    -2


det(scriptO) =

    -4

</pre><h2 id="5">5.4: Estimator Gains</h2><pre class="codeinput"><span class="comment">% estimator gain matrix</span>
syms <span class="string">L1</span> <span class="string">L2</span> <span class="string">L3</span> <span class="string">L4</span>
L = [L1; L2; L3; L4];

sL = -10;  <span class="comment">% desired pole location</span>

<span class="comment">% Symbolic (L) char poly coeffs</span>
LPoly = det(eye(length(A))*s - (A - L*C))
LCoeffs = coeffs(LPoly, s)

<span class="comment">% Numeric char poly coeffs</span>
EstPoly = expand((s-sR)^length(A))
EstCoeffs = coeffs(EstPoly, s)

<span class="comment">% Solve for K from coeffs</span>
LValsStruct = solve(EstCoeffs == LCoeffs);

<span class="comment">% Extract K values</span>
LNames = fieldnames(LValsStruct);
L = [];
<span class="keyword">for</span> i = 1:length(LNames)
    L = [L; double(LValsStruct.(LNames{i}))];
<span class="keyword">end</span>
disp(<span class="string">'--------------------------------------------------------'</span>)
L
disp(<span class="string">'--------------------------------------------------------'</span>)

<span class="comment">% Check</span>
AminusLCeig = eig(A - L*C)
</pre><pre class="codeoutput"> 
LPoly =
 
2*L3 + 2*L4 + 2*L1*s + 2*L2*s + L2*s^3 + L4*s^2 + 4*s^2 + s^4
 
 
LCoeffs =
 
[ 2*L3 + 2*L4, 2*L1 + 2*L2, L4 + 4, L2, 1]
 
 
EstPoly =
 
s^4 + 40*s^3 + 600*s^2 + 4000*s + 10000
 
 
EstCoeffs =
 
[ 10000, 4000, 600, 40, 1]
 
--------------------------------------------------------

L =

        1960
          40
        4404
         596

--------------------------------------------------------

AminusLCeig =

 -10.0022 + 0.0000i
 -10.0000 + 0.0022i
 -10.0000 - 0.0022i
  -9.9978 + 0.0000i

</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2017a</a><br></p></div><!--
##### SOURCE BEGIN #####
%%
% Marion Anderson
% ECE 4550 Fall 2018
% HW 5

clear; clc; close all

M1 = 1; M2 = 1;

A = [0  0 1 0
     0  0 0 1
    -2  2 0 0
     2 -2 0 0];
B = [0; 0; 1 ;0];
C = [0 1 0 0];

%% 5.1: Controllability

scriptC = B;  % Initial controllability matrix
for n = 1:length(A)-1  % adding to controllability matrix
    scriptC = [scriptC, (A^n) * B];
end

fprintf('\n'); disp('scriptC ='); fprintf('\n')
disp(scriptC)
fprintf('\n'); disp('det(scriptC) ='); fprintf('\n')
disp(det(scriptC))


% The controllability matrix has non-zero determinant, and so must be
% full rank. This system is controllable.

%% 5.2: Regulator Gains

% regulator gain matrix
syms K1 K2 K3 K4 s
K = [K1 K2 K3 K4];

sR = -10;  % desired pole location

% Symbolic (K) char poly coeffs
KPoly = det(eye(length(A))*s - (A - B*K))
KCoeffs = coeffs(KPoly, s)

% Numeric char poly coeffs
RegPoly = expand((s-sR)^length(A))
RegCoeffs = coeffs(RegPoly, s)

% Solve for K from coeffs
KValsStruct = solve(RegCoeffs == KCoeffs);

% Extract K values
KNames = fieldnames(KValsStruct);
K = [];
for i = 1:length(KNames)
    K = [K double(KValsStruct.(KNames{i}))];
end
disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH')
K
disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH')

% Check
AminusBKeig = eig(A - B*K)


%% 5.3: Observability

scriptO = C;  % Initial observability matrix
for n = 1:length(A)-1  % adding to observability matrix
    scriptO = [scriptO; C * (A^n)];
end

fprintf('\n'); disp('scriptO ='); fprintf('\n')
disp(scriptO)
fprintf('\n'); disp('det(scriptO) ='); fprintf('\n')
disp(det(scriptO))


% The observability matrix has non-zero determinant, and so must be
% full rank. This system is observabile.

%% 5.4: Estimator Gains

% estimator gain matrix
syms L1 L2 L3 L4
L = [L1; L2; L3; L4];

sL = -10;  % desired pole location

% Symbolic (L) char poly coeffs
LPoly = det(eye(length(A))*s - (A - L*C))
LCoeffs = coeffs(LPoly, s)

% Numeric char poly coeffs
EstPoly = expand((s-sR)^length(A))
EstCoeffs = coeffs(EstPoly, s)

% Solve for K from coeffs
LValsStruct = solve(EstCoeffs == LCoeffs);

% Extract K values
LNames = fieldnames(LValsStruct);
L = [];
for i = 1:length(LNames)
    L = [L; double(LValsStruct.(LNames{i}))];
end
disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH')
L
disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH')

% Check
AminusLCeig = eig(A - L*C)
##### SOURCE END #####
--></body></html>